

## 利用BLH坐标计算两颗卫星距离
### 模型框架
BLH坐标系是一种地理坐标系统，它是基于地球椭球面的经度（B）、纬度（L）和大地高（H）来表示点的位置。它的原点是地球质心，xy平面是赤道面，x轴指向本初子午线，z轴垂直于xy平面。

主要采取以下步骤：

- 首先，将BLH坐标转换为ECEF坐标，即地心地固坐标系，它是一种直角坐标系，与BLH坐标系有相同的原点和z轴，但是xy平面与赤道面重合。转换公式如下：

$$X = (N + H) \cos B \cos L$$
$$Y = (N + H) \cos B \sin L$$
$$Z = (N(1 - e^2) + H) \sin B$$

其中，$N$是卯酉圈曲率半径，$e$是第一偏心率，它们都是由地球椭球参数决定的常数。

- 然后，利用ECEF坐标计算两颗卫星距离，可以使用欧几里得空间中两点之间的距离公式：

$$d = \sqrt{(X_1 - X_2)^2 + (Y_1 - Y_2)^2 + (Z_1 - Z_2)^2}$$

其中，$d$是两颗卫星的距离，$(X_1, Y_1, Z_1)$和$(X_2, Y_2, Z_2)$是两颗卫星在ECEF坐标系下的坐标。

这个方法可以得到两颗卫星距离的近似值，但是如果要考虑地球的引力场和其他摄动因素，可能需要使用更复杂的模型和方法来计算两颗卫星距离。


[使用STK 计算两颗卫星的距离](https://blog.csdn.net/weixin_41487423/article/details/130289151)  

### 模型修正


卯酉圈是指地平坐标系中与子午圈相垂直的大圆。卯酉圈上一点的曲率半径用N表示，它是由椭球体的长半径a、第一偏心率e和大地纬度B决定的。计算公式如下：

$$N = \frac{a}{\sqrt{1 - e^2 \sin^2 B}}$$

这个公式是基于椭球体的几何性质推导出来的。不同纬度上的卯酉圈曲率半径长度会有所变化，一般来说，随着纬度的增大，卯酉圈曲率半径也会增大。

上式中的B，是指大地纬度，也就是地球椭球面上一点与赤道面所成的角度。大地纬度和地理纬度（也就是天球上一点与赤道面所成的角度）有微小的差别，因为地球不是完美的球体。一般来说，这种差别可以忽略不计，除非需要非常精确的测量。

如果要纳入考虑大地纬度和地理纬度的差别，应该使用以下公式来计算：

$$\tan \phi = \frac{1 - e^2}{1 - e^2 \sin^2 B} \tan B$$

其中，$\phi$是地理纬度，$B$是大地纬度，$e$是第一偏心率，它是由地球椭球参数决定的常数。

这个公式是基于椭球体的几何性质推导出来的。一般来说，大地纬度和地理纬度的差别不超过0.2°，只有在高精度的测量中才需要考虑。


[卯酉圈 - 维基百科](https://zh.wikipedia.org/wiki/%E5%8D%AF%E9%85%89%E5%9C%88)


python代码可参考：[地固坐标系(xyz)转大地坐标系(BLH)的公式分析](https://zhuanlan.zhihu.com/p/358210424)