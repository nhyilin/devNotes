#include <Eigen/Dense>
#include <Eigen/QR>
#include <cmath>
#include <iostream>
#include <vector>

#include "matplotlibcpp.h"

namespace plt = matplotlibcpp;

void polyfit(const std::vector<double> &t, const std::vector<double> &v,
             std::vector<double> &coeff, int order

) {
  // Create Matrix Placeholder of size n x k, n= number of datapoints, k =
  // order of polynomial, for exame k = 3 for cubic polynomial
  Eigen::MatrixXd T(t.size(), order + 1);
  Eigen::VectorXd V = Eigen::VectorXd::Map(&v.front(), v.size());

  Eigen::VectorXd result;

  // check to make sure inputs are correct
  assert(t.size() == v.size());
  assert(t.size() >= order + 1);
  // Populate the matrix
  for (size_t i = 0; i < t.size(); ++i) {
    for (size_t j = 0; j < order + 1; ++j) {
      T(i, j) = pow(t.at(i), j);
    }
  }
  std::cout << T << std::endl;

  // Solve for linear least square fit
  result = T.householderQr().solve(V);
  coeff.resize(order + 1);
  for (int k = 0; k < order + 1; k++) {
    coeff[k] = result[k];
  }
}

int main() {
  // time value
  std::vector<double> time = {152.833345,
                              153.430754,
                              153.916678,
                              154.583356,
                              154.750012,
                              154.916690,
                              155.583345,
                              155.666678,
                              155.833345,
                              156.083345,
                              156.833345,
                              156.916678,
                              157.583345,
                              157.916678,
                              158.250012,
                              158.500012,
                              158.583345,
                              158.750012,
                              158.916678,
                              159.416690,
                              159.666678,
                              160.166678,
                              160.500012,
                              160.666678,
                              160.916690,
                              161.083345,
                              161.166678,
                              161.416690,
                              161.583345,
                              161.666678,
                              161.916678,
                              162.000012,
                              162.083345,
                              162.416690,
                              162.500012,
                              162.583345,
                              162.666678,
                              162.750023,
                              162.916678,
                              163.166678,
                              163.416678,
                              163.500046,
                              163.583345,
                              163.916678,
                              164.250012,
                              164.333356,
                              164.583345,
                              164.666690,
                              164.916678,
                              165.000012,
                              165.166678,
                              165.416678,
                              165.500023,
                              165.583345,
                              165.666690,
                              165.916678,
                              166.083345,
                              166.166678,
                              166.250012,
                              166.333356,
                              166.500012,
                              166.666678,
                              166.833345,
                              166.916678,
                              167.000012,
                              167.166678,
                              167.333356,
                              167.583345,
                              167.916678,
                              168.166678,
                              168.250012,
                              168.333368,
                              168.916678,
                              169.000012,
                              169.166678,
                              169.333356,
                              169.583345,
                              169.666678,
                              169.916690,
                              170.166678,
                              170.333356,
                              170.583345,
                              170.666678,
                              170.750012,
                              171.416678,
                              171.583356,
                              171.666690,
                              171.750012,
                              171.833345,
                              171.916678,
                              172.166678,
                              172.333356,
                              172.416690,
                              172.583356,
                              172.666690,
                              172.833345,
                              172.916690,
                              173.250012,
                              173.333356,
                              173.583356,
                              173.666678,
                              173.833345,
                              173.916678,
                              174.083345,
                              174.166678,
                              174.250012,
                              174.333345,
                              174.500012,
                              174.666678,
                              174.833356,
                              174.916678,
                              175.083356,
                              175.250023,
                              175.416690,
                              175.833345,
                              175.916678,
                              176.000023,
                              176.083345,
                              176.583345,
                              176.666678,
                              176.833345,
                              176.916690,
                              177.000012,
                              177.166678,
                              177.416690,
                              177.500012,
                              177.583345,
                              177.833345,
                              177.916690,
                              178.166678,
                              178.333356,
                              178.416690,
                              178.583356,
                              178.666678,
                              178.833345,
                              178.916678,
                              179.166678,
                              179.250012,
                              179.333356,
                              179.500023,
                              179.666678,
                              179.916678,
                              180.166678,
                              180.250012,
                              180.333345,
                              180.500012,
                              180.750012,
                              180.916678,
                              181.166678,
                              181.250012,
                              181.416690,
                              181.500012,
                              181.666678,
                              182.166690,
                              182.500012,
                              182.583345,
                              182.666678,
                              182.916678,
                              183.166678,
                              183.416690,
                              183.500012,
                              183.583345,
                              183.666678,
                              183.833345,
                              183.916678,
                              184.000012,
                              184.166678,
                              184.416678,
                              184.500023,
                              184.750012,
                              184.833356,
                              184.916678,
                              185.083345,
                              185.166678,
                              185.250012,
                              185.416678,
                              185.500012,
                              185.666690,
                              185.833345,
                              185.916678,
                              186.000012,
                              186.166678,
                              186.416678,
                              186.500012,
                              186.583345,
                              186.750012,
                              186.916678,
                              187.083345,
                              187.166678,
                              187.333356,
                              187.500023,
                              187.583345,
                              187.833345,
                              187.916678,
                              188.166678,
                              188.333356,
                              188.583345,
                              188.833345,
                              188.916678,
                              189.500012,
                              189.916690,
                              190.250012,
                              190.583356,
                              190.916678,
                              191.500012,
                              191.583345,
                              191.916701,
                              192.250012,
                              192.583345,
                              192.916678,
                              193.250012,
                              193.583345,
                              193.916678,
                              194.000023,
                              194.583345,
                              194.916678,
                              195.583345,
                              195.833345,
                              195.916678,
                              196.583345,
                              196.916678,
                              197.583345,
                              197.916678,
                              198.250012,
                              198.583345,
                              198.916678,
                              199.250023,
                              199.583345,
                              199.916678,
                              200.250012,
                              200.583345,
                              200.916690,
                              201.583345,
                              201.916678,
                              202.583345,
                              202.666678,
                              202.885741,
                              203.350412,
                              203.500023,
                              203.916690,
                              204.000012,
                              204.583345,
                              204.916678,
                              205.250012,
                              205.583345,
                              205.916678,
                              206.583356,
                              206.916678,
                              207.250012,
                              207.916678,
                              208.583356,
                              208.916678,
                              209.250012,
                              209.583345,
                              209.916690,
                              210.583345,
                              210.916678,
                              211.250012,
                              211.416690,
                              211.833345,
                              211.916678,
                              212.583356,
                              212.916678,
                              213.250012,
                              213.583345,
                              213.916678,
                              214.250023,
                              214.916678,
                              215.250012,
                              215.916678,
                              216.250012,
                              216.583345,
                              216.916690,
                              217.583356,
                              217.916678,
                              218.583345,
                              218.916678,
                              219.583345,
                              219.916690,
                              220.583345,
                              220.916678,
                              221.250012,
                              221.583345,
                              221.916678,
                              222.583345,
                              222.916690,
                              223.250012,
                              223.583345,
                              223.916678,
                              224.250012,
                              224.916678,
                              225.583345,
                              225.916690,
                              226.250012,
                              226.416678,
                              226.916690,
                              227.250012,
                              227.583345,
                              228.250012,
                              228.583356,
                              228.916678,
                              229.250023,
                              229.583345,
                              229.916678,
                              230.583345,
                              230.916678,
                              231.583345,
                              231.916678,
                              232.250012,
                              232.583345,
                              232.890659,
                              233.083345,
                              233.583345,
                              233.916678,
                              234.583345,
                              234.916678,
                              235.250023,
                              235.583356,
                              235.916678,
                              236.583356,
                              236.916678,
                              237.250012,
                              237.583345,
                              237.916678,
                              238.583356,
                              238.916690,
                              239.250012,
                              239.583345,
                              239.916678,
                              240.250012,
                              240.416678,
                              240.916690,
                              241.583345,
                              241.916678,
                              242.583345,
                              242.916678,
                              243.583345,
                              243.916678,
                              244.583345,
                              244.916678,
                              245.583356,
                              245.916678,
                              246.250012,
                              246.583345,
                              246.916678,
                              247.583345,
                              247.833345,
                              247.916678,
                              248.583345,
                              248.916690,
                              249.250012,
                              249.583345,
                              249.916678,
                              250.250012,
                              250.583345,
                              250.750012,
                              251.250012,
                              251.583356,
                              251.916678,
                              252.250012,
                              252.583356,
                              252.916678,
                              253.250012,
                              253.916678,
                              254.250012,
                              254.916678,
                              255.250012,
                              255.583345,
                              255.916678,
                              256.583345,
                              256.916678,
                              257.250012,
                              257.583356,
                              257.916678,
                              258.583345,
                              258.916678,
                              259.250012,
                              259.583345,
                              259.916690,
                              260.250012,
                              260.583356,
                              260.916678,
                              261.416678,
                              261.583356,
                              261.916678,
                              262.583345,
                              262.916678,
                              263.250012,
                              263.583345,
                              263.833345,
                              264.583345,
                              264.833345,
                              265.250023,
                              265.583345,
                              265.916690,
                              266.250012,
                              266.583345,
                              266.833356,
                              266.916678,
                              267.583345,
                              267.916678,
                              268.583345,
                              268.833345,
                              268.916690,
                              269.583345,
                              269.865706,
                              269.916690,
                              270.583449,
                              270.861449,
                              270.916678,
                              271.583380,
                              271.857190,
                              272.583356,
                              272.916678,
                              273.250023,
                              273.583356,
                              273.916713,
                              274.583345,
                              274.916678,
                              275.000012,
                              275.583345,
                              275.916690,
                              276.583345,
                              276.916678,
                              277.583356,
                              277.916748,
                              278.583345,
                              278.916678,
                              279.250012,
                              279.583356,
                              279.916701,
                              280.154999,
                              280.885204,
                              280.951586,
                              281.748171,
                              281.880935,
                              282.544757,
                              282.611152,
                              282.876682,
                              283.540510,
                              284.071573,
                              284.868165,
                              285.465611,
                              285.531991,
                              285.797513,
                              285.863895,
                              286.527718,
                              286.793272,
                              286.859655,
                              287.457094,
                              287.523467,
                              287.722613,
                              288.320053,
                              288.585582,
                              289.315802,
                              289.581316,
                              290.577059,
                              290.709824,
                              290.975354,
                              291.771944,
                              292.502152,
                              292.767680,
                              293.232364,
                              293.697042,
                              294.560014,
                              294.692779,
                              295.223838,
                              296.219572,
                              296.551482,
                              297.547213,
                              297.879121,
                              298.476576,
                              298.874872,
                              299.538697,
                              299.870609,
                              300.534437,
                              300.866350,
                              301.530175,
                              301.596557,
                              302.393146,
                              302.791439,
                              303.521643,
                              303.787171,
                              304.119081,
                              304.251845,
                              304.451005,
                              304.782918,
                              305.513127,
                              305.778657,
                              306.442485,
                              306.774398,
                              307.172694,
                              307.504607,
                              308.234815,
                              308.433963,
                              308.699493,
                              309.496083,
                              309.695230,
                              310.425434,
                              310.690963,
                              311.155638,
                              311.421166,
                              311.686694,
                              312.416909,
                              312.682440,
                              316.200720,
                              316.399867,
                              317.262838,
                              318.590480,
                              319.121536,
                              319.652599,
                              320.316430,
                              321.312168,
                              321.776847,
                              322.108762,
                              323.104501,
                              323.502796,
                              324.100237,
                              324.498531,
                              325.162352,
                              325.494263,
                              326.025326,
                              326.888306,
                              327.220217,
                              327.817659,
                              328.149567,
                              328.415103,
                              328.879781,
                              328.946163,
                              329.941898,
                              330.141044,
                              330.406573,
                              330.871247,
                              331.402303,
                              331.800595,
                              331.866982,
                              332.066136,
                              332.132519,
                              333.128254,
                              333.327402,
                              334.323141,
                              334.588671,
                              334.854200,
                              335.318878,
                              335.783554,
                              336.314611,
                              336.845669,
                              337.044829,
                              337.310360,
                              337.841423,
                              338.040571,
                              338.837165,
                              339.500998,
                              339.832900,
                              340.032045,
                              340.895014,
                              341.027778,
                              341.226924,
                              341.492452,
                              341.757993,
                              341.890758,
                              342.222669,
                              342.886493,
                              343.483936,
                              343.948615,
                              344.811589,
                              344.944355,
                              345.541798,
                              345.740945,
                              345.940092,
                              346.603917,
                              346.736681,
                              347.134975,
                              347.798798,
                              348.130709,
                              348.794530,
                              349.591114,
                              349.790273,
                              350.520463,
                              350.653225,
                              351.516186,
                              351.781739,
                              352.578332,
                              352.644715,
                              353.043012,
                              353.773224,
                              354.503443,
                              354.835358,
                              355.499189,
                              355.764721,
                              356.494932,
                              356.694081,
                              357.490672,
                              358.486409,
                              358.685556,
                              359.482157,
                              359.747687,
                              359.946822,
                              360.544258,
                              360.610640,
                              361.473605,
                              361.938277,
                              362.469341,
                              363.199543,
                              363.597834,
                              364.394422,
                              364.859110,
                              365.456552,
                              365.655699,
                              366.120380,
                              366.452118,
                              366.651440,
                              366.850591};

  // velocity value
  std::vector<double> velocity = {552.645299,
                                  552.610963,
                                  552.417554,
                                  552.386725,
                                  552.703840,
                                  552.414778,
                                  552.491942,
                                  552.745195,
                                  552.525638,
                                  552.696069,
                                  552.509725,
                                  552.552470,
                                  552.609952,
                                  552.591428,
                                  552.665974,
                                  552.448267,
                                  552.669720,
                                  552.604500,
                                  552.619805,
                                  552.371095,
                                  552.637563,
                                  552.476097,
                                  552.433084,
                                  552.579404,
                                  552.662083,
                                  552.499772,
                                  552.612805,
                                  552.386540,
                                  552.746322,
                                  552.607471,
                                  552.659803,
                                  552.554776,
                                  552.509069,
                                  552.399714,
                                  552.632179,
                                  552.720678,
                                  552.561573,
                                  552.496606,
                                  552.637564,
                                  552.694560,
                                  552.437948,
                                  552.671079,
                                  552.679008,
                                  552.599553,
                                  552.622505,
                                  552.399539,
                                  552.643666,
                                  552.514505,
                                  552.569517,
                                  552.497215,
                                  552.721870,
                                  552.551774,
                                  552.701527,
                                  552.596955,
                                  552.513289,
                                  552.530526,
                                  552.646830,
                                  552.706831,
                                  552.490200,
                                  552.400928,
                                  552.673828,
                                  552.522395,
                                  552.586906,
                                  552.488104,
                                  552.522066,
                                  552.654303,
                                  552.430491,
                                  552.518137,
                                  552.470187,
                                  552.596905,
                                  552.397406,
                                  552.545318,
                                  552.555439,
                                  552.685839,
                                  552.537931,
                                  552.525326,
                                  552.491387,
                                  552.586333,
                                  552.464097,
                                  552.464989,
                                  552.583458,
                                  552.520226,
                                  552.613233,
                                  552.580884,
                                  552.614046,
                                  552.561993,
                                  552.626719,
                                  552.535286,
                                  552.432291,
                                  552.552348,
                                  552.381447,
                                  552.650463,
                                  552.559006,
                                  552.591269,
                                  552.614102,
                                  552.504978,
                                  552.693872,
                                  552.640941,
                                  552.743821,
                                  552.716576,
                                  552.691646,
                                  552.533652,
                                  552.751411,
                                  552.551413,
                                  552.463867,
                                  552.675537,
                                  552.711718,
                                  552.616522,
                                  552.647906,
                                  552.577009,
                                  552.767068,
                                  552.390060,
                                  552.617424,
                                  552.426588,
                                  552.525147,
                                  552.726175,
                                  552.596961,
                                  552.352331,
                                  552.634237,
                                  552.454458,
                                  552.590295,
                                  552.727977,
                                  552.531458,
                                  552.597796,
                                  552.542358,
                                  552.736631,
                                  552.716791,
                                  552.758600,
                                  552.818242,
                                  552.683034,
                                  552.508462,
                                  552.597223,
                                  552.663110,
                                  552.442288,
                                  552.811245,
                                  552.746779,
                                  552.620412,
                                  552.533679,
                                  552.383915,
                                  552.648949,
                                  552.323615,
                                  552.592204,
                                  552.691003,
                                  552.559380,
                                  552.489600,
                                  552.707631,
                                  552.661282,
                                  552.608337,
                                  552.684648,
                                  552.526280,
                                  552.738068,
                                  552.675315,
                                  552.472062,
                                  552.657187,
                                  552.629071,
                                  552.445450,
                                  552.522054,
                                  552.397122,
                                  552.532676,
                                  552.684649,
                                  552.485137,
                                  552.318286,
                                  552.468629,
                                  552.545922,
                                  552.304456,
                                  552.504686,
                                  552.551808,
                                  552.734307,
                                  552.499436,
                                  552.786245,
                                  552.594388,
                                  552.444986,
                                  552.676983,
                                  552.489814,
                                  552.505292,
                                  552.692962,
                                  552.443048,
                                  552.704838,
                                  552.530179,
                                  552.451132,
                                  552.640317,
                                  552.437969,
                                  552.623761,
                                  552.394568,
                                  552.485475,
                                  552.715833,
                                  552.482027,
                                  552.577222,
                                  552.419277,
                                  552.770575,
                                  552.375418,
                                  552.542752,
                                  552.438159,
                                  552.525764,
                                  552.427611,
                                  552.747242,
                                  552.607735,
                                  552.428181,
                                  552.579778,
                                  552.404992,
                                  552.632063,
                                  552.771533,
                                  552.721291,
                                  552.661899,
                                  552.502386,
                                  552.747109,
                                  552.662881,
                                  552.755850,
                                  552.743474,
                                  552.634698,
                                  552.790582,
                                  552.810564,
                                  552.682566,
                                  552.472892,
                                  552.709710,
                                  552.538931,
                                  552.624465,
                                  552.636932,
                                  552.469234,
                                  552.513430,
                                  552.488073,
                                  552.590279,
                                  552.439309,
                                  552.447160,
                                  552.534019,
                                  552.411953,
                                  552.417427,
                                  552.502909,
                                  552.410044,
                                  552.450587,
                                  552.396865,
                                  552.328272,
                                  552.408647,
                                  552.482107,
                                  552.530111,
                                  552.696245,
                                  552.529559,
                                  552.526308,
                                  552.477829,
                                  552.602045,
                                  552.772044,
                                  552.612886,
                                  552.659320,
                                  552.593461,
                                  552.645049,
                                  552.703790,
                                  552.673438,
                                  552.724017,
                                  552.714969,
                                  552.854608,
                                  552.673179,
                                  552.721978,
                                  552.627892,
                                  552.645480,
                                  552.760644,
                                  552.645065,
                                  552.702357,
                                  552.685473,
                                  552.559136,
                                  552.697480,
                                  552.554860,
                                  552.484483,
                                  552.593706,
                                  552.568541,
                                  552.455353,
                                  552.545906,
                                  552.559502,
                                  552.430279,
                                  552.376708,
                                  552.486599,
                                  552.491997,
                                  552.381153,
                                  552.483725,
                                  552.405545,
                                  552.497323,
                                  552.452634,
                                  552.524510,
                                  552.510519,
                                  552.556867,
                                  552.570277,
                                  552.584562,
                                  552.658162,
                                  552.610400,
                                  552.600889,
                                  552.735922,
                                  552.696639,
                                  552.795758,
                                  552.735037,
                                  552.729196,
                                  552.705573,
                                  552.580430,
                                  552.581794,
                                  552.639380,
                                  552.722912,
                                  552.482294,
                                  552.588700,
                                  552.649647,
                                  552.603094,
                                  552.566528,
                                  552.547687,
                                  552.478547,
                                  552.496743,
                                  552.515555,
                                  552.456406,
                                  552.514667,
                                  552.454568,
                                  552.528438,
                                  552.466653,
                                  552.423770,
                                  552.557679,
                                  552.652169,
                                  552.720616,
                                  552.592587,
                                  552.525094,
                                  552.626506,
                                  552.567621,
                                  552.498931,
                                  552.651451,
                                  552.607507,
                                  552.661155,
                                  552.642938,
                                  552.558779,
                                  552.660379,
                                  552.675347,
                                  552.643695,
                                  552.653878,
                                  552.673584,
                                  552.708375,
                                  552.775698,
                                  552.645381,
                                  552.606067,
                                  552.711164,
                                  552.502675,
                                  552.559126,
                                  552.538022,
                                  552.646250,
                                  552.519393,
                                  552.507572,
                                  552.350768,
                                  552.392616,
                                  552.393782,
                                  552.475927,
                                  552.412865,
                                  552.385331,
                                  552.456796,
                                  552.410364,
                                  552.534395,
                                  552.470062,
                                  552.458050,
                                  552.507020,
                                  552.565247,
                                  552.520612,
                                  552.561004,
                                  552.648451,
                                  552.588190,
                                  552.585267,
                                  552.724606,
                                  552.650552,
                                  552.673060,
                                  552.776844,
                                  552.695403,
                                  552.695586,
                                  552.795555,
                                  552.689190,
                                  552.746630,
                                  552.713360,
                                  552.794470,
                                  552.735082,
                                  552.662716,
                                  552.691483,
                                  552.593068,
                                  552.649819,
                                  552.624448,
                                  552.495545,
                                  552.542124,
                                  552.395735,
                                  552.448817,
                                  552.465901,
                                  552.317012,
                                  552.377816,
                                  552.394267,
                                  552.344557,
                                  552.758767,
                                  552.466612,
                                  552.342315,
                                  552.463662,
                                  552.363714,
                                  552.424256,
                                  552.485167,
                                  552.364917,
                                  552.525287,
                                  552.299738,
                                  552.516948,
                                  552.592329,
                                  552.569969,
                                  552.583767,
                                  552.662826,
                                  552.297606,
                                  552.657104,
                                  552.728869,
                                  552.732341,
                                  552.780820,
                                  552.426641,
                                  552.781204,
                                  552.692097,
                                  552.567005,
                                  552.794427,
                                  552.794837,
                                  552.605222,
                                  552.840848,
                                  552.801458,
                                  552.615897,
                                  552.720276,
                                  552.707159,
                                  552.621088,
                                  552.628702,
                                  552.633485,
                                  552.531004,
                                  552.558960,
                                  552.450235,
                                  552.353302,
                                  552.409261,
                                  552.368128,
                                  552.468119,
                                  552.328720,
                                  552.449125,
                                  552.315642,
                                  552.458189,
                                  552.421886,
                                  552.334023,
                                  552.487772,
                                  552.628255,
                                  552.608362,
                                  552.603207,
                                  552.620604,
                                  552.619575,
                                  552.620457,
                                  552.665483,
                                  552.661793,
                                  552.663214,
                                  552.663302,
                                  552.650955,
                                  552.664892,
                                  552.654864,
                                  552.627498,
                                  552.626133,
                                  552.621940,
                                  552.694184,
                                  552.693509,
                                  552.595673,
                                  552.612424,
                                  552.607712,
                                  552.608775,
                                  552.634541,
                                  552.771719,
                                  552.604616,
                                  552.640173,
                                  552.639550,
                                  552.634225,
                                  552.633065,
                                  552.652556,
                                  552.596806,
                                  552.649737,
                                  552.641175,
                                  552.628019,
                                  552.626718,
                                  552.616674,
                                  552.600116,
                                  552.592092,
                                  552.578142,
                                  552.566287,
                                  552.612292,
                                  552.615890,
                                  552.610625,
                                  552.609688,
                                  552.617578,
                                  552.612217,
                                  552.598577,
                                  552.595672,
                                  552.579286,
                                  552.570941,
                                  552.558979,
                                  552.552961,
                                  552.546566,
                                  552.545654,
                                  552.588490,
                                  552.585797,
                                  552.581736,
                                  552.574730,
                                  552.639772,
                                  552.584876,
                                  552.576171,
                                  552.568226,
                                  552.556347,
                                  552.554519,
                                  552.549927,
                                  552.532912,
                                  552.529337,
                                  552.516231,
                                  552.511843,
                                  552.504874,
                                  552.498498,
                                  552.493723,
                                  552.527912,
                                  552.527730,
                                  552.506320,
                                  552.502445,
                                  552.489252,
                                  552.465418,
                                  552.456388,
                                  552.473346,
                                  552.494441,
                                  552.488052,
                                  552.495594,
                                  552.509591,
                                  552.493322,
                                  552.483363,
                                  552.476043,
                                  552.469815,
                                  552.459755,
                                  552.455826,
                                  552.458735,
                                  552.494919,
                                  552.482515,
                                  552.476274,
                                  552.440911,
                                  552.492692,
                                  552.483561,
                                  552.481764,
                                  552.470856,
                                  552.464359,
                                  552.460618,
                                  552.454156,
                                  552.447101,
                                  552.446887,
                                  552.449670,
                                  552.483800,
                                  552.483694,
                                  552.480243,
                                  552.482032,
                                  552.503767,
                                  552.502790,
                                  552.494490,
                                  552.492109,
                                  552.488768,
                                  552.479829,
                                  552.484302,
                                  552.531971,
                                  552.522739,
                                  552.526809,
                                  552.527720,
                                  552.510812,
                                  552.556107,
                                  552.511995,
                                  552.504480,
                                  552.493067,
                                  552.492058,
                                  552.491376,
                                  552.491447,
                                  552.512240,
                                  552.514749,
                                  552.516229,
                                  552.522248,
                                  552.530528,
                                  552.545440,
                                  552.545078,
                                  552.543975,
                                  552.541811,
                                  552.540203,
                                  552.539687,
                                  552.543563,
                                  552.542936,
                                  552.541176,
                                  552.536605,
                                  552.533378,
                                  552.533582,
                                  552.529899,
                                  552.568282,
                                  552.532644,
                                  552.515132,
                                  552.504541,
                                  552.586117,
                                  552.579675,
                                  552.581877,
                                  552.584973,
                                  552.621168,
                                  552.622729,
                                  552.614656,
                                  552.608379,
                                  552.601877,
                                  552.591316,
                                  552.588305,
                                  552.572008,
                                  552.552072,
                                  552.542672,
                                  552.573276,
                                  552.568939,
                                  552.524874,
                                  552.510269,
                                  552.509563,
                                  552.501020,
                                  552.488971,
                                  552.497886,
                                  552.494829,
                                  552.480656,
                                  552.516861,
                                  552.537703,
                                  552.535456,
                                  552.534350,
                                  552.527625,
                                  551.466132,
                                  552.535421,
                                  552.555956};

  // placeholder for storing polynomial coefficient
  std::vector<double> coeff;
  polyfit(time, velocity, coeff, 3);

  std::vector<double> fitted_velocity;
  std::cout << "Printing fitted values" << std::endl;
  for (int p = 0; p < time.size(); ++p) {
    double vfitted = coeff[0] + coeff[1] * time.at(p) + coeff[2] * (pow(time.at(p), 2)) + coeff[3] * (pow(time.at(p), 3));
    std::cout << vfitted << ", ";
    fitted_velocity.push_back(vfitted);
  }
  std::cout << std::endl;

  /*原始数据*/
  plt::figure();
  plt::title("originaldata");
  plt::plot(time, velocity);

  plt::figure();
  /*最小二乘拟合后的数据*/
  plt::title("polyfitdata");
  plt::plot(time, fitted_velocity);
  plt::show();
  return 0;
}
